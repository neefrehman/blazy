!function(t,e){"function"==typeof define&&define.amd?define(e):"object"==typeof exports?module.exports=e():t.Blazy=e()}(this,function(){"use strict";var l,f,d,o="srcset";return function(t){var e=this,n=e._util={};n.elements=[],e.options=t||{},e.options.offset=e.options.offset||100,e.options.selector=e.options.selector||".b-lazy",e.options.srcset=e.options.srcset||"data-srcset",e.options.src=l=e.options.src||"data-src",d=1<window.devicePixelRatio,(f={}).top=0-e.options.offset,f.left=0-e.options.offset,e.revalidate=function(){i(e)},e.load=function(t,e){var n=this.options;t&&void 0===t.length?r(t,e,n):function(t,e){if(t&&e)for(var n=t.length,o=0;o<n&&!1!==e(t[o],o);o++);}(t,function(t){r(t,e,n)})},n.validateT=a(function(){s(e)},e),n.saveViewportOffsetT=a(function(){u(e.options.offset)},50,e),u(e.options.offset),setTimeout(function(){i(e)})};function i(t){var e=t._util;e.elements=function(t){for(var e=[],n=document.querySelectorAll(t.selector),o=n.length;o--;e.unshift(n[o]));return e}(t.options),e.count=e.elements.length,w(window,"resize",e.saveViewportOffsetT),w(window,"resize",e.validateT),w(window,"scroll",e.validateT),s(t)}function s(t){for(var e,n,o,i,s=t._util,r=0;r<s.count;r++){var c=s.elements[r];o=c,t.options,void 0,i=o.getBoundingClientRect(),n=f,((e=i).right>=n.left&&e.bottom>=n.top&&e.left<=n.right&&e.top<=n.bottom||g(c))&&(t.load(c),s.elements.splice(r,1),s.count--,r--)}0===s.count&&t.destroy()}function r(n,t,o){if(!g(n)&&(t||0<n.offsetWidth&&0<n.offsetHeight)){var e=v(n,l)||v(n,o.src);if(e){var i=e.split("|"),s=i[d&&1<i.length?1:0],r=v(n,o.srcset),c=h(n,"img"),f=n.parentNode,u=f&&h(f,"picture");if(c||void 0===n.src){var a=new Image;w(a,"error",function(){}),w(a,"load",function(){var t,e;c?u||p(n,s,r):n.style.backgroundImage=`url(${src})`,m(t=n,(e=o).src),m(t,e.srcset)}),p(a,s,r)}}}}function p(t,e,n){n&&c(t,o,n),t.src=e}function c(t,e,n){t.setAttribute(e,n)}function v(t,e){return t.getAttribute(e)}function m(t,e){t.removeAttribute(e)}function h(t,e){return t.nodeName.toLowerCase()===e}function g(t,e){return-1!==(" "+t.className+" ").indexOf(" "+e+" ")}function u(t){f.bottom=(window.innerHeight||document.documentElement.clientHeight)+t,f.right=(window.innerWidth||document.documentElement.clientWidth)+t}function w(t,e,n){t.attachEvent?t.attachEvent&&t.attachEvent("on"+e,n):t.addEventListener(e,n,{capture:!1,passive:!0})}function a(e,n,o){var i=0;return function(){var t=+new Date;t-i<n||(i=t,e.apply(o,arguments))}}});
