!function(t,e){"function"==typeof define&&define.amd?define(e):"object"==typeof exports?module.exports=e():t.Blazy=e()}(this,function(){"use strict";var u,f,l,o="srcset";return function(t){var e=this,n=e._util={};n.elements=[],e.options=t||{},e.options.offset=e.options.offset||100,e.options.selector=e.options.selector||".b-lazy",e.options.srcset=e.options.srcset||"data-srcset",e.options.src=u=e.options.src||"data-src",l=1<window.devicePixelRatio,(f={}).top=0-e.options.offset,f.left=0-e.options.offset,e.revalidate=function(){i(e)},e.load=function(t,e){var n=this.options;t&&void 0===t.length?r(t,e,n):function(t,e){if(t&&e)for(var n=t.length,o=0;o<n&&!1!==e(t[o],o);o++);}(t,function(t){r(t,e,n)})},n.validateT=g(function(){s(e)},e),n.saveViewportOffsetT=g(function(){a(e.options.offset)},50,e),a(e.options.offset),setTimeout(function(){i(e)})};function i(t){var e=t._util;e.elements=function(t){for(var e=[],n=document.querySelectorAll(t.selector),o=n.length;o--;e.unshift(n[o]));return e}(t.options),e.count=e.elements.length,h(window,"resize",e.saveViewportOffsetT),h(window,"resize",e.validateT),h(window,"scroll",e.validateT),s(t)}function s(t){for(var e,n,o,i,s=t._util,r=0;r<s.count;r++){var c=s.elements[r];o=c,t.options,void 0,i=o.getBoundingClientRect(),n=f,((e=i).right>=n.left&&e.bottom>=n.top&&e.left<=n.right&&e.top<=n.bottom||m(c))&&(t.load(c),s.elements.splice(r,1),s.count--,r--)}0===s.count&&t.destroy()}function r(n,t,o){if(!m(n)&&(t||0<n.offsetWidth&&0<n.offsetHeight)){var e=p(n,u)||p(n,o.src);if(e){var i=e.split("|"),s=i[l&&1<i.length?1:0],r=p(n,o.srcset),c=(a="img",n.nodeName.toLowerCase()===a);n.parentNode;if(c||void 0===n.src){var f=new Image;h(f,"error",function(){}),h(f,"load",function(){var t,e;c?d(n,s,r):n.style.backgroundImage=`url(${src})`,v(t=n,(e=o).src),v(t,e.srcset)}),d(f,s,r)}}}var a}function d(t,e,n){n&&c(t,o,n),t.src=e}function c(t,e,n){t.setAttribute(e,n)}function p(t,e){return t.getAttribute(e)}function v(t,e){t.removeAttribute(e)}function m(t,e){return-1!==(" "+t.className+" ").indexOf(" "+e+" ")}function a(t){f.bottom=(window.innerHeight||document.documentElement.clientHeight)+t,f.right=(window.innerWidth||document.documentElement.clientWidth)+t}function h(t,e,n){t.attachEvent?t.attachEvent&&t.attachEvent("on"+e,n):t.addEventListener(e,n,{capture:!1,passive:!0})}function g(e,n,o){var i=0;return function(){var t=+new Date;t-i<n||(i=t,e.apply(o,arguments))}}});
